#include <iostream>
#include <iomanip>

#include <Windows.h>
#include <bcrypt.h>

#include "print_utils.h"
#include "aes_statics.h"

#include "aes.h"

#include "base64.h"

using namespace std;

int main()
{
	//unsigned char buffer[16] = { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };
	//Aes128 t = Aes128(buffer);

	//unsigned char buffer[24] = { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };
	//Aes192 t = Aes192(buffer);

	//unsigned char buffer[32] = { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };
	//Aes256 t = Aes256(buffer);

	//unsigned char buffer[16] = { 0xa1, 0xb2, 0xc3, 0x18, 0x89, 0x28, 0xba, 0x08, 0x5f, 0x0a, 0xab, 0x2c, 0x1d, 0x5e, 0x0f, 0x10 };
	unsigned char buffer[16] = { 0x2b, 0x7e, 0x15, 0x16, 0x28, 0xae, 0xd2, 0xa6, 0xab, 0xf7, 0x15, 0x88, 0x09, 0xcf, 0x4f, 0x3c };
	Aes128 t = Aes128(buffer);

	//unsigned char plain[16] = { 0x0ff, 0xfe, 0xfd, 0xfc, 0xfb, 0xfa, 0xf9, 0xf8, 0xf7, 0xf6, 0xf5, 0xf4, 0xf3, 0xf2, 0xf1, 0xf0 };

	unsigned char plain[16] = { 0x32, 0x43, 0xf6, 0xa8, 0x88, 0x5a, 0x30, 0x8d, 0x31, 0x31, 0x98, 0xa2, 0xe0, 0x37, 0x07, 0x34 };
	unsigned char tmp[16];

	t.EncryptBlock(plain, tmp);
	PrintHex(tmp, 16);

	t.DecryptBlock(tmp, tmp);
	PrintHex(tmp, 16);

	std::cin.get();
	return 0;
}

