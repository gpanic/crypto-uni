#include <iostream>
#include <iomanip>

#include <Windows.h>
#include <bcrypt.h>

#include "print_utils.h"
#include "aes_statics.h"

#include "aes.h"

#include "base64.h"

using namespace std;

void GenerateKey(unsigned char *in, unsigned int size)
{
	BCryptGenRandom(0, in, size, BCRYPT_USE_SYSTEM_PREFERRED_RNG);
}

int main()
{
	string s = { 0x00, 0x05, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };
	string e = b64_enc(s);
	string d = b64_dec(e);

	cout << e << endl;
	cout << d << endl;

	//unsigned char buffer[16] = { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };
	//Aes128 t = Aes128(buffer);

	//unsigned char buffer[24] = { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };
	//Aes192 t = Aes192(buffer);

	unsigned char buffer[32] = { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };
	Aes256 t = Aes256(buffer);

	t.Encrypt();

	std::cin.get();
	return 0;
}

